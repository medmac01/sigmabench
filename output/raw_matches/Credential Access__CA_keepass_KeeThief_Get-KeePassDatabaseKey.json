[{
  "title": "Remote Thread Created In KeePass.EXE",
  "id": "77564cc2-7382-438b-a7f6-395c2ae53b9a",
  "description": "Detects remote thread creation in \"KeePass.exe\" which could indicates potential password dumping activity",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=8 AND TargetImage LIKE '%\\\\KeePass.exe' ESCAPE '\\')"
  ],
  "rule_level": "high",
  "tags": [
    "attack.credential-access",
    "attack.t1555.005"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 1,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "IEWIN7",
      "EventID": 8,
      "EventRecordID": 7070,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "NewThreadId": 3796,
      "Opcode": 0,
      "OriginalLogfile": "CA_keepass_KeeThief_Get-KeePassDatabaseKey.evtx",
      "ProcessID": 1816,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
      "SourceProcessGuid": "365ABB72-A512-5CC4-0000-0010C05E1B00",
      "SourceProcessId": 2856,
      "StartAddress": "0x76FAEC4B",
      "StartFunction": "DbgUiRemoteBreakin",
      "StartModule": "C:\\Windows\\SYSTEM32\\ntdll.dll",
      "SystemTime": "2019-04-27T18:55:04.710608Z",
      "TargetImage": "C:\\Program Files\\KeePass Password Safe 2\\KeePass.exe",
      "TargetProcessGuid": "365ABB72-A201-5CC4-0000-00104F500800",
      "TargetProcessId": 2364,
      "Task": 8,
      "ThreadID": 1228,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-04-27 18:55:04.710",
      "Version": 2
    },
    {
      "row_id": 2,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "IEWIN7",
      "EventID": 8,
      "EventRecordID": 7071,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "NewThreadId": 1384,
      "Opcode": 0,
      "OriginalLogfile": "CA_keepass_KeeThief_Get-KeePassDatabaseKey.evtx",
      "ProcessID": 1816,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
      "SourceProcessGuid": "365ABB72-A512-5CC4-0000-0010C05E1B00",
      "SourceProcessId": 2856,
      "StartAddress": "0x06160000",
      "SystemTime": "2019-04-27T18:55:04.980137Z",
      "TargetImage": "C:\\Program Files\\KeePass Password Safe 2\\KeePass.exe",
      "TargetProcessGuid": "365ABB72-A201-5CC4-0000-00104F500800",
      "TargetProcessId": 2364,
      "Task": 8,
      "ThreadID": 1228,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-04-27 18:55:04.980",
      "Version": 2
    }
  ]
}]