[{
  "title": "MSSQL Server Failed Logon",
  "id": "218d2855-2bba-4f61-9c85-81d0ea63ac71",
  "description": "Detects failed logon attempts from clients to MSSQL server.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Application' AND (Provider_Name LIKE '%MSSQL%' ESCAPE '\\' AND EventID=18456)"
  ],
  "rule_level": "low",
  "tags": [
    "attack.credential-access",
    "attack.t1110"
  ],
  "count": 10,
  "matches": [
    {
      "row_id": 1,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13026,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['sa', ' Reason: Password did not match that for the login provided.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.171339Z",
      "Task": 4
    },
    {
      "row_id": 2,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13027,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_SQLResourceSigningCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.187637Z",
      "Task": 4
    },
    {
      "row_id": 3,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13028,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_SQLReplicationSigningCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.202731Z",
      "Task": 4
    },
    {
      "row_id": 4,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13029,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_SQLAuthenticatorCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.202731Z",
      "Task": 4
    },
    {
      "row_id": 5,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13030,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_PolicySigningCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.222452Z",
      "Task": 4
    },
    {
      "row_id": 6,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13031,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_SmoExtendedSigningCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.233944Z",
      "Task": 4
    },
    {
      "row_id": 7,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13032,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_PolicyEventProcessingLogin##', ' Reason: An error occurred while evaluating the password.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.248423Z",
      "Task": 4
    },
    {
      "row_id": 8,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13033,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_PolicyTsqlExecutionLogin##', ' Reason: An error occurred while evaluating the password.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.248883Z",
      "Task": 4
    },
    {
      "row_id": 9,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13034,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['##MS_AgentSigningCertificate##', ' Reason: Attempting to use an NT account name with SQL Server Authentication.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.266435Z",
      "Task": 4
    },
    {
      "row_id": 10,
      "Binary": "184800000E0000000C0000004D0053004500440047004500570049004E00310030000000070000006D00610073007400650072000000",
      "Channel": "Application",
      "Computer": "MSEDGEWIN10",
      "EventID": 18456,
      "EventRecordID": 13035,
      "Keywords": "0x90000000000000",
      "Level": 0,
      "Message": "['root', ' Reason: Password did not match that for the login provided.', ' [CLIENT: 10.0.2.17]']",
      "OriginalLogfile": "MSSQL_multiple_failed_logon_EventID_18456.evtx",
      "Provider_Name": "MSSQLSERVER",
      "Qualifiers": 49152,
      "SystemTime": "2019-11-04T13:46:01.279825Z",
      "Task": 4
    }
  ]
}]