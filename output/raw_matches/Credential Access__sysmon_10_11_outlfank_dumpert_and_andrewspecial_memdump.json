[{
  "title": "HackTool - Dumpert Process Dumper Default File",
  "id": "93d94efc-d7ad-4161-ad7d-1638c4f908d8",
  "description": "Detects the creation of the default dump file used by Outflank Dumpert tool. A process dumper, which dumps the lsass process memory",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=11 AND TargetFilename LIKE '%dumpert.dmp' ESCAPE '\\')"
  ],
  "rule_level": "critical",
  "tags": [
    "attack.credential-access",
    "attack.t1003.001"
  ],
  "count": 3,
  "matches": [
    {
      "row_id": 3,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "CreationUtcTime": "2019-06-21 06:53:03.227",
      "EventID": 11,
      "EventRecordID": 238375,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Image": "C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessGuid": "ECAD0485-88C9-5D0C-0000-0010348C1D00",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SystemTime": "2019-06-21T07:35:37.329185Z",
      "TargetFileName": "C:\\Windows\\Temp\\dumpert.dmp",
      "Task": 11,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:37.324",
      "Version": 2
    },
    {
      "row_id": 7,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "CreationUtcTime": "2019-06-21 06:53:03.227",
      "EventID": 11,
      "EventRecordID": 238380,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Image": "C:\\Windows\\system32\\rundll32.exe",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessGuid": "ECAD0485-88D6-5D0C-0000-001007AA1D00",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SystemTime": "2019-06-21T07:35:50.259077Z",
      "TargetFileName": "C:\\Windows\\Temp\\dumpert.dmp",
      "Task": 11,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:50.258",
      "Version": 2
    },
    {
      "row_id": 10,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "CreationUtcTime": "2019-06-21 06:53:03.227",
      "EventID": 11,
      "EventRecordID": 238383,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Image": "C:\\Windows\\system32\\rundll32.exe",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessGuid": "ECAD0485-88D6-5D0C-0000-001007AA1D00",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SystemTime": "2019-06-21T07:35:50.729226Z",
      "TargetFileName": "C:\\Windows\\Temp\\dumpert.dmp",
      "Task": 11,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:50.727",
      "Version": 2
    }
  ]
},
{
  "title": "Suspicious Process Access to LSASS with Dbgcore/Dbghelp DLLs",
  "id": "9f5c1d59-33be-4e60-bcab-85d2f566effd",
  "description": "Detects suspicious process access to LSASS.exe from processes located in uncommon locations with dbgcore.dll or dbghelp.dll in the call trace.\nThese DLLs contain functions like MiniDumpWriteDump that can be abused for credential dumping purposes. While modern tools like Mimikatz have moved to using ntdll.dll,\ndbgcore.dll and dbghelp.dll are still used by basic credential dumping utilities and legacy tools for LSASS memory access and process suspension techniques.\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=10 AND ((TargetImage LIKE '%\\\\lsass.exe' ESCAPE '\\' AND (CallTrace LIKE '%dbgcore.dll%' ESCAPE '\\' OR CallTrace LIKE '%dbghelp.dll%' ESCAPE '\\')) AND (SourceImage LIKE '%:\\\\Perflogs\\\\%' ESCAPE '\\' OR SourceImage LIKE '%:\\\\Temp\\\\%' ESCAPE '\\' OR SourceImage LIKE '%:\\\\Users\\\\Public\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\$Recycle.Bin\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\AppData\\\\Roaming\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Contacts\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Desktop\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Documents\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Downloads\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Favorites\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Favourites\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\inetpub\\\\wwwroot\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Music\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Pictures\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Start Menu\\\\Programs\\\\Startup\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Users\\\\Default\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Videos\\\\%' ESCAPE '\\' OR SourceImage LIKE '%\\\\Windows\\\\Temp\\\\%' ESCAPE '\\')))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.credential-access",
    "attack.t1003.001",
    "attack.defense-evasion",
    "attack.t1562.001"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 4,
      "CallTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\system32\\ctiuser.dll+1b132|C:\\Windows\\SYSTEM32\\ntdll.dll+80498|C:\\Windows\\system32\\KERNEL32.DLL+1e1d4|C:\\Windows\\system32\\KERNEL32.DLL+1dc17|C:\\Windows\\system32\\ctiuser.dll+141be|C:\\Windows\\SYSTEM32\\dbghelp.dll+1244d8|C:\\Windows\\SYSTEM32\\dbghelp.dll+11ebd5|C:\\Windows\\SYSTEM32\\dbghelp.dll+118402|C:\\Windows\\SYSTEM32\\dbghelp.dll+1137e2|C:\\Windows\\SYSTEM32\\dbghelp.dll+113c84|C:\\Windows\\system32\\ctiuser.dll+22232|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+130a5|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f09|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13dae|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13c6e|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f99|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "EventID": 10,
      "EventRecordID": 238376,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe",
      "SourceProcessGUID": "ECAD0485-88C9-5D0C-0000-0010348C1D00",
      "SourceProcessId": 3572,
      "SourceThreadId": 3532,
      "SystemTime": "2019-06-21T07:35:37.377199Z",
      "TargetImage": "C:\\Windows\\system32\\lsass.exe",
      "TargetProcessGUID": "ECAD0485-822F-5D0C-0000-0010635E0000",
      "TargetProcessId": 520,
      "Task": 10,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:37.377",
      "Version": 3
    },
    {
      "row_id": 15,
      "CallTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\SYSTEM32\\wow64.dll+7174|C:\\Windows\\SYSTEM32\\wow64.dll+9c7b|C:\\Windows\\system32\\wow64cpu.dll+1dc5|C:\\Windows\\SYSTEM32\\wow64.dll+1235a|C:\\Windows\\SYSTEM32\\wow64.dll+12292|C:\\Windows\\SYSTEM32\\ntdll.dll+c3d95|C:\\Windows\\SYSTEM32\\ntdll.dll+a24de|C:\\Windows\\SYSTEM32\\ntdll.dll+18c9e|C:\\Windows\\SYSTEM32\\ntdll.dll+3c55c(wow64)|C:\\Windows\\SYSTEM32\\ctiuser.dll+1a81e(wow64)|C:\\Windows\\SYSTEM32\\ntdll.dll+b7088(wow64)|C:\\Windows\\SYSTEM32\\KERNEL32.DLL+39bb1(wow64)|C:\\Windows\\SYSTEM32\\KERNEL32.DLL+29911(wow64)|C:\\Windows\\SYSTEM32\\ctiuser.dll+13d59(wow64)|C:\\Windows\\SYSTEM32\\dbghelp.dll+f852f(wow64)|C:\\Windows\\SYSTEM32\\dbghelp.dll+f39c3(wow64)|C:\\Windows\\SYSTEM32\\dbghelp.dll+ee1a7(wow64)|C:\\Windows\\SYSTEM32\\dbghelp.dll+e9e2e(wow64)|C:\\Windows\\SYSTEM32\\dbghelp.dll+ea1f5(wow64)|C:\\Windows\\SYSTEM32\\ctiuser.dll+214b2(wow64)|C:\\Users\\administrator\\Desktop\\AndrewSpecial.exe+11c9|C:\\Users\\administrator\\Desktop\\AndrewSpecial.exe+16ad|C:\\Users\\administrator\\Desktop\\AndrewSpecial.exe+1b1b",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "EventID": 10,
      "EventRecordID": 238388,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\administrator\\Desktop\\AndrewSpecial.exe",
      "SourceProcessGUID": "ECAD0485-8912-5D0C-0000-0010FD2F1F00",
      "SourceProcessId": 3552,
      "SourceThreadId": 3532,
      "SystemTime": "2019-06-21T07:36:51.682572Z",
      "TargetImage": "C:\\Windows\\system32\\lsass.exe",
      "TargetProcessGUID": "ECAD0485-822F-5D0C-0000-0010635E0000",
      "TargetProcessId": 520,
      "Task": 10,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:36:50.992",
      "Version": 3
    }
  ]
},
{
  "title": "LSASS Memory Access by Tool With Dump Keyword In Name",
  "id": "9bd012ee-0dff-44d7-84a0-aa698cfd87a3",
  "description": "Detects LSASS process access requests from a source process with the \"dump\" keyword in its image name.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=10 AND (TargetImage LIKE '%\\\\lsass.exe' ESCAPE '\\' AND SourceImage LIKE '%dump%' ESCAPE '\\' AND (GrantedAccess LIKE '%10' ESCAPE '\\' OR GrantedAccess LIKE '%30' ESCAPE '\\' OR GrantedAccess LIKE '%50' ESCAPE '\\' OR GrantedAccess LIKE '%70' ESCAPE '\\' OR GrantedAccess LIKE '%90' ESCAPE '\\' OR GrantedAccess LIKE '%B0' ESCAPE '\\' OR GrantedAccess LIKE '%D0' ESCAPE '\\' OR GrantedAccess LIKE '%F0' ESCAPE '\\' OR GrantedAccess LIKE '%18' ESCAPE '\\' OR GrantedAccess LIKE '%38' ESCAPE '\\' OR GrantedAccess LIKE '%58' ESCAPE '\\' OR GrantedAccess LIKE '%78' ESCAPE '\\' OR GrantedAccess LIKE '%98' ESCAPE '\\' OR GrantedAccess LIKE '%B8' ESCAPE '\\' OR GrantedAccess LIKE '%D8' ESCAPE '\\' OR GrantedAccess LIKE '%F8' ESCAPE '\\' OR GrantedAccess LIKE '%1A' ESCAPE '\\' OR GrantedAccess LIKE '%3A' ESCAPE '\\' OR GrantedAccess LIKE '%5A' ESCAPE '\\' OR GrantedAccess LIKE '%7A' ESCAPE '\\' OR GrantedAccess LIKE '%9A' ESCAPE '\\' OR GrantedAccess LIKE '%BA' ESCAPE '\\' OR GrantedAccess LIKE '%DA' ESCAPE '\\' OR GrantedAccess LIKE '%FA' ESCAPE '\\' OR GrantedAccess LIKE '%0x14C2' ESCAPE '\\' OR GrantedAccess LIKE '%FF' ESCAPE '\\')))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.credential-access",
    "attack.t1003.001",
    "attack.s0002"
  ],
  "count": 2,
  "matches": [
    {
      "row_id": 2,
      "CallTrace": "C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+134da|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+12e6d|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f09|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13dae|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13c6e|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f99|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "EventID": 10,
      "EventRecordID": 238374,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe",
      "SourceProcessGUID": "ECAD0485-88C9-5D0C-0000-0010348C1D00",
      "SourceProcessId": 3572,
      "SourceThreadId": 3532,
      "SystemTime": "2019-06-21T07:35:37.329185Z",
      "TargetImage": "C:\\Windows\\system32\\lsass.exe",
      "TargetProcessGUID": "ECAD0485-822F-5D0C-0000-0010635E0000",
      "TargetProcessId": 520,
      "Task": 10,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:37.316",
      "Version": 3
    },
    {
      "row_id": 4,
      "CallTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\system32\\ctiuser.dll+1b132|C:\\Windows\\SYSTEM32\\ntdll.dll+80498|C:\\Windows\\system32\\KERNEL32.DLL+1e1d4|C:\\Windows\\system32\\KERNEL32.DLL+1dc17|C:\\Windows\\system32\\ctiuser.dll+141be|C:\\Windows\\SYSTEM32\\dbghelp.dll+1244d8|C:\\Windows\\SYSTEM32\\dbghelp.dll+11ebd5|C:\\Windows\\SYSTEM32\\dbghelp.dll+118402|C:\\Windows\\SYSTEM32\\dbghelp.dll+1137e2|C:\\Windows\\SYSTEM32\\dbghelp.dll+113c84|C:\\Windows\\system32\\ctiuser.dll+22232|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+130a5|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f09|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13dae|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13c6e|C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe+13f99|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "EventID": 10,
      "EventRecordID": 238376,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\administrator\\Desktop\\x64\\Outflank-Dumpert.exe",
      "SourceProcessGUID": "ECAD0485-88C9-5D0C-0000-0010348C1D00",
      "SourceProcessId": 3572,
      "SourceThreadId": 3532,
      "SystemTime": "2019-06-21T07:35:37.377199Z",
      "TargetImage": "C:\\Windows\\system32\\lsass.exe",
      "TargetProcessGUID": "ECAD0485-822F-5D0C-0000-0010635E0000",
      "TargetProcessId": 520,
      "Task": 10,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:35:37.377",
      "Version": 3
    }
  ]
},
{
  "title": "LSASS Process Memory Dump Files",
  "id": "a5a2d357-1ab8-4675-a967-ef9990a59391",
  "description": "Detects creation of files with names used by different memory dumping tools to create a memory dump of the LSASS process memory, which contains user credentials.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=11 AND ((TargetFilename LIKE '%\\\\Andrew.dmp' ESCAPE '\\' OR TargetFilename LIKE '%\\\\Coredump.dmp' ESCAPE '\\' OR TargetFilename LIKE '%\\\\lsass.dmp' ESCAPE '\\' OR TargetFilename LIKE '%\\\\lsass.rar' ESCAPE '\\' OR TargetFilename LIKE '%\\\\lsass.zip' ESCAPE '\\' OR TargetFilename LIKE '%\\\\NotLSASS.zip' ESCAPE '\\' OR TargetFilename LIKE '%\\\\PPLBlade.dmp' ESCAPE '\\' OR TargetFilename LIKE '%\\\\rustive.dmp' ESCAPE '\\') OR (TargetFilename LIKE '%\\\\lsass\\_2%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\lsassdmp%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\lsassdump%' ESCAPE '\\') OR (TargetFilename LIKE '%\\\\lsass%' ESCAPE '\\' AND TargetFilename LIKE '%.dmp%' ESCAPE '\\') OR (TargetFilename LIKE '%SQLDmpr%' ESCAPE '\\' AND TargetFilename LIKE '%.mdmp' ESCAPE '\\') OR ((TargetFilename LIKE '%\\\\nanodump%' ESCAPE '\\' OR TargetFilename LIKE '%\\\\proc\\_%' ESCAPE '\\') AND TargetFilename LIKE '%.dmp' ESCAPE '\\')))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.credential-access",
    "attack.t1003.001"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 14,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "alice.insecurebank.local",
      "CreationUtcTime": "2019-06-21 07:36:50.985",
      "EventID": 11,
      "EventRecordID": 238387,
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Image": "C:\\Users\\administrator\\Desktop\\AndrewSpecial.exe",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_10_11_outlfank_dumpert_and_andrewspecial_memdump.evtx",
      "ProcessGuid": "ECAD0485-8912-5D0C-0000-0010FD2F1F00",
      "ProcessID": 1560,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SystemTime": "2019-06-21T07:36:51.681567Z",
      "TargetFileName": "C:\\Users\\administrator\\Desktop\\Andrew.dmp",
      "Task": 11,
      "ThreadID": 2316,
      "UserID": "S-1-5-18",
      "UtcTime": "2019-06-21 07:36:50.985",
      "Version": 2
    }
  ]
}]