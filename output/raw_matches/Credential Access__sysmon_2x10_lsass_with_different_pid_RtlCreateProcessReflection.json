[{
  "title": "LSASS Memory Access by Tool With Dump Keyword In Name",
  "id": "9bd012ee-0dff-44d7-84a0-aa698cfd87a3",
  "description": "Detects LSASS process access requests from a source process with the \"dump\" keyword in its image name.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=10 AND (TargetImage LIKE '%\\\\lsass.exe' ESCAPE '\\' AND SourceImage LIKE '%dump%' ESCAPE '\\' AND (GrantedAccess LIKE '%10' ESCAPE '\\' OR GrantedAccess LIKE '%30' ESCAPE '\\' OR GrantedAccess LIKE '%50' ESCAPE '\\' OR GrantedAccess LIKE '%70' ESCAPE '\\' OR GrantedAccess LIKE '%90' ESCAPE '\\' OR GrantedAccess LIKE '%B0' ESCAPE '\\' OR GrantedAccess LIKE '%D0' ESCAPE '\\' OR GrantedAccess LIKE '%F0' ESCAPE '\\' OR GrantedAccess LIKE '%18' ESCAPE '\\' OR GrantedAccess LIKE '%38' ESCAPE '\\' OR GrantedAccess LIKE '%58' ESCAPE '\\' OR GrantedAccess LIKE '%78' ESCAPE '\\' OR GrantedAccess LIKE '%98' ESCAPE '\\' OR GrantedAccess LIKE '%B8' ESCAPE '\\' OR GrantedAccess LIKE '%D8' ESCAPE '\\' OR GrantedAccess LIKE '%F8' ESCAPE '\\' OR GrantedAccess LIKE '%1A' ESCAPE '\\' OR GrantedAccess LIKE '%3A' ESCAPE '\\' OR GrantedAccess LIKE '%5A' ESCAPE '\\' OR GrantedAccess LIKE '%7A' ESCAPE '\\' OR GrantedAccess LIKE '%9A' ESCAPE '\\' OR GrantedAccess LIKE '%BA' ESCAPE '\\' OR GrantedAccess LIKE '%DA' ESCAPE '\\' OR GrantedAccess LIKE '%FA' ESCAPE '\\' OR GrantedAccess LIKE '%0x14C2' ESCAPE '\\' OR GrantedAccess LIKE '%FF' ESCAPE '\\')))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.credential-access",
    "attack.t1003.001",
    "attack.s0002"
  ],
  "count": 3,
  "matches": [
    {
      "row_id": 1,
      "CallTrace": "C:\\windows\\SYSTEM32\\ntdll.dll+9c534|C:\\windows\\System32\\wow64.dll+ba94|C:\\windows\\System32\\wow64.dll+7123|C:\\windows\\System32\\wow64cpu.dll+1783|C:\\windows\\System32\\wow64cpu.dll+1199|C:\\windows\\System32\\wow64.dll+c77a|C:\\windows\\System32\\wow64.dll+c637|C:\\windows\\SYSTEM32\\ntdll.dll+718eb|C:\\windows\\SYSTEM32\\ntdll.dll+717d3|C:\\windows\\SYSTEM32\\ntdll.dll+7177e|C:\\windows\\SYSTEM32\\ntdll.dll+7208c(wow64)|C:\\windows\\System32\\KERNELBASE.dll+f10a8(wow64)|C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump.exe+7c36|C:\\windows\\System32\\KERNEL32.DLL+16359(wow64)|C:\\windows\\SYSTEM32\\ntdll.dll+67c24(wow64)|C:\\windows\\SYSTEM32\\ntdll.dll+67bf4(wow64)",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "LAPTOP-JU4M3I0E",
      "EventID": 10,
      "EventRecordID": 2125126,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_2x10_lsass_with_different_pid_RtlCreateProcessReflection.evtx",
      "ProcessID": 5320,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump.exe",
      "SourceProcessGUID": "00247C92-EE6B-5F04-0000-00108C67A859",
      "SourceProcessId": 30256,
      "SourceThreadId": 5576,
      "SystemTime": "2020-07-07T21:51:39.204637Z",
      "TargetImage": "C:\\windows\\system32\\lsass.exe",
      "TargetProcessGUID": "00247C92-DC62-5EEF-0000-001026F60100",
      "TargetProcessId": 908,
      "Task": 10,
      "ThreadID": 6908,
      "UserID": "S-1-5-18",
      "UtcTime": "2020-07-07 21:51:39.203",
      "Version": 3
    },
    {
      "row_id": 2,
      "CallTrace": "C:\\windows\\SYSTEM32\\ntdll.dll+9c534|C:\\windows\\System32\\KERNELBASE.dll+2726e|C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump64.exe+82b4|C:\\windows\\System32\\KERNEL32.DLL+17bd4|C:\\windows\\SYSTEM32\\ntdll.dll+6ce51",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "LAPTOP-JU4M3I0E",
      "EventID": 10,
      "EventRecordID": 2125128,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_2x10_lsass_with_different_pid_RtlCreateProcessReflection.evtx",
      "ProcessID": 5320,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump64.exe",
      "SourceProcessGUID": "00247C92-EE6B-5F04-0000-00109069A859",
      "SourceProcessId": 28528,
      "SourceThreadId": 3444,
      "SystemTime": "2020-07-07T21:51:39.256632Z",
      "TargetImage": "C:\\windows\\system32\\lsass.exe",
      "TargetProcessGUID": "00247C92-DC62-5EEF-0000-001026F60100",
      "TargetProcessId": 908,
      "Task": 10,
      "ThreadID": 6908,
      "UserID": "S-1-5-18",
      "UtcTime": "2020-07-07 21:51:39.256",
      "Version": 3
    },
    {
      "row_id": 3,
      "CallTrace": "C:\\windows\\SYSTEM32\\ntdll.dll+9ca14|C:\\windows\\SYSTEM32\\ntdll.dll+110610|C:\\windows\\System32\\KERNELBASE.dll+d68de|C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump64.exe+120bb|C:\\windows\\System32\\KERNEL32.DLL+17bd4|C:\\windows\\SYSTEM32\\ntdll.dll+6ce51",
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "Computer": "LAPTOP-JU4M3I0E",
      "EventID": 10,
      "EventRecordID": 2125129,
      "GrantedAccess": "0x1fffff",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "Opcode": 0,
      "OriginalLogfile": "sysmon_2x10_lsass_with_different_pid_RtlCreateProcessReflection.evtx",
      "ProcessID": 5320,
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SourceImage": "C:\\Users\\Public\\tools\\SysinternalsSuite\\procdump64.exe",
      "SourceProcessGUID": "00247C92-EE6B-5F04-0000-00109069A859",
      "SourceProcessId": 28528,
      "SourceThreadId": 22356,
      "SystemTime": "2020-07-07T21:51:39.262862Z",
      "TargetImage": "C:\\windows\\system32\\lsass.exe",
      "TargetProcessGUID": "00247C92-EE6B-5F04-0000-00105C6CA859",
      "TargetProcessId": 30096,
      "Task": 10,
      "ThreadID": 6908,
      "UserID": "S-1-5-18",
      "UtcTime": "2020-07-07 21:51:39.262",
      "Version": 3
    }
  ]
}]