[{
  "title": "Suspect Svchost Activity",
  "id": "16c37b52-b141-42a5-a3ea-bbe098444397",
  "description": "It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=1 AND ((CommandLine LIKE '%svchost.exe' ESCAPE '\\' AND Image LIKE '%\\\\svchost.exe' ESCAPE '\\') AND (NOT ((ParentImage LIKE '%\\\\rpcnet.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\rpcnetp.exe' ESCAPE '\\') OR CommandLine IS NULL))))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.privilege-escalation",
    "attack.t1055"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 7,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "CommandLine": "C:\\Windows\\system32\\svchost.exe",
      "Company": "Microsoft Corporation",
      "Computer": "IEWIN7",
      "CurrentDirectory": "C:\\Windows\\system32\\",
      "Description": "Host Process for Windows Services",
      "EventID": 1,
      "EventRecordID": 4863,
      "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Hashes": "SHA1=4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878,MD5=54A47F6B5E09A77E61649109C6A08866,SHA256=121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2,IMPHASH=58E185299ECCA757FE68BA83A6495FDE",
      "IMPHASH": "58E185299ECCA757FE68BA83A6495FDE",
      "Image": "C:\\Windows\\System32\\svchost.exe",
      "IntegrityLevel": "System",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "LogonGuid": "365ABB72-8DBD-5CEA-0000-0020E7030000",
      "LogonId": "0x3e7",
      "MD5": "54A47F6B5E09A77E61649109C6A08866",
      "Opcode": 0,
      "OriginalLogfile": "apt10_jjs_sideloading_prochollowing_persist_as_service_sysmon_1_7_8_13.evtx",
      "ParentCommandLine": "\"C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe\"",
      "ParentImage": "C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe",
      "ParentProcessGuid": "365ABB72-0FA6-5CEA-0000-0010FEC30A00",
      "ParentProcessId": 3884,
      "ProcessGuid": "365ABB72-0FA7-5CEA-0000-001064C60A00",
      "ProcessID": 984,
      "Product": "Microsoft® Windows® Operating System",
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SHA1": "4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878",
      "SHA256": "121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2",
      "SystemTime": "2019-05-26T04:01:43.567204Z",
      "Task": 1,
      "TerminalSessionId": 0,
      "ThreadID": 2352,
      "User": "NT AUTHORITY\\SYSTEM",
      "UserID": "S-1-5-18",
      "UtcTime": "2019-05-26 04:01:43.557",
      "Version": 5
    }
  ]
},
{
  "title": "Uncommon Svchost Command Line Parameter",
  "id": "f17211f1-1f24-4d0c-829f-31e28dc93cdd",
  "description": "Detects instances of svchost.exe running with an unusual or uncommon command line parameter by excluding known legitimate or common patterns.\nThis could point at a file masquerading as svchost, a process injection, or hollowing of a legitimate svchost instance.\n",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=1 AND (Image LIKE '%\\\\svchost.exe' ESCAPE '\\' AND (NOT (CommandLine REGEXP '-k\\s\\w{1,64}(\\s?(-p|-s))?' OR CommandLine='' OR CommandLine IS NULL)) AND (NOT ((ParentImage LIKE '%\\\\MsMpEng.exe' ESCAPE '\\' AND CommandLine LIKE '%svchost.exe%' ESCAPE '\\') OR (ParentImage LIKE '%\\\\MRT.exe' ESCAPE '\\' AND CommandLine='svchost.exe')))))"
  ],
  "rule_level": "high",
  "tags": [
    "attack.defense-evasion",
    "attack.privilege-escalation",
    "attack.t1036.005",
    "attack.t1055",
    "attack.t1055.012"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 7,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "CommandLine": "C:\\Windows\\system32\\svchost.exe",
      "Company": "Microsoft Corporation",
      "Computer": "IEWIN7",
      "CurrentDirectory": "C:\\Windows\\system32\\",
      "Description": "Host Process for Windows Services",
      "EventID": 1,
      "EventRecordID": 4863,
      "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Hashes": "SHA1=4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878,MD5=54A47F6B5E09A77E61649109C6A08866,SHA256=121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2,IMPHASH=58E185299ECCA757FE68BA83A6495FDE",
      "IMPHASH": "58E185299ECCA757FE68BA83A6495FDE",
      "Image": "C:\\Windows\\System32\\svchost.exe",
      "IntegrityLevel": "System",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "LogonGuid": "365ABB72-8DBD-5CEA-0000-0020E7030000",
      "LogonId": "0x3e7",
      "MD5": "54A47F6B5E09A77E61649109C6A08866",
      "Opcode": 0,
      "OriginalLogfile": "apt10_jjs_sideloading_prochollowing_persist_as_service_sysmon_1_7_8_13.evtx",
      "ParentCommandLine": "\"C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe\"",
      "ParentImage": "C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe",
      "ParentProcessGuid": "365ABB72-0FA6-5CEA-0000-0010FEC30A00",
      "ParentProcessId": 3884,
      "ProcessGuid": "365ABB72-0FA7-5CEA-0000-001064C60A00",
      "ProcessID": 984,
      "Product": "Microsoft® Windows® Operating System",
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SHA1": "4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878",
      "SHA256": "121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2",
      "SystemTime": "2019-05-26T04:01:43.567204Z",
      "Task": 1,
      "TerminalSessionId": 0,
      "ThreadID": 2352,
      "User": "NT AUTHORITY\\SYSTEM",
      "UserID": "S-1-5-18",
      "UtcTime": "2019-05-26 04:01:43.557",
      "Version": 5
    }
  ]
},
{
  "title": "Uncommon Svchost Parent Process",
  "id": "01d2e2a1-5f09-44f7-9fc1-24faa7479b6d",
  "description": "Detects an uncommon svchost parent process",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=1 AND (Image LIKE '%\\\\svchost.exe' ESCAPE '\\' AND (NOT ((ParentImage LIKE '%\\\\Mrt.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\MsMpEng.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\ngen.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\rpcnet.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\services.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\TiWorker.exe' ESCAPE '\\') OR ParentImage IS NULL OR (ParentImage='-' OR ParentImage='')))))"
  ],
  "rule_level": "medium",
  "tags": [
    "attack.defense-evasion",
    "attack.t1036.005"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 7,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "CommandLine": "C:\\Windows\\system32\\svchost.exe",
      "Company": "Microsoft Corporation",
      "Computer": "IEWIN7",
      "CurrentDirectory": "C:\\Windows\\system32\\",
      "Description": "Host Process for Windows Services",
      "EventID": 1,
      "EventRecordID": 4863,
      "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Hashes": "SHA1=4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878,MD5=54A47F6B5E09A77E61649109C6A08866,SHA256=121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2,IMPHASH=58E185299ECCA757FE68BA83A6495FDE",
      "IMPHASH": "58E185299ECCA757FE68BA83A6495FDE",
      "Image": "C:\\Windows\\System32\\svchost.exe",
      "IntegrityLevel": "System",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "LogonGuid": "365ABB72-8DBD-5CEA-0000-0020E7030000",
      "LogonId": "0x3e7",
      "MD5": "54A47F6B5E09A77E61649109C6A08866",
      "Opcode": 0,
      "OriginalLogfile": "apt10_jjs_sideloading_prochollowing_persist_as_service_sysmon_1_7_8_13.evtx",
      "ParentCommandLine": "\"C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe\"",
      "ParentImage": "C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe",
      "ParentProcessGuid": "365ABB72-0FA6-5CEA-0000-0010FEC30A00",
      "ParentProcessId": 3884,
      "ProcessGuid": "365ABB72-0FA7-5CEA-0000-001064C60A00",
      "ProcessID": 984,
      "Product": "Microsoft® Windows® Operating System",
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SHA1": "4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878",
      "SHA256": "121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2",
      "SystemTime": "2019-05-26T04:01:43.567204Z",
      "Task": 1,
      "TerminalSessionId": 0,
      "ThreadID": 2352,
      "User": "NT AUTHORITY\\SYSTEM",
      "UserID": "S-1-5-18",
      "UtcTime": "2019-05-26 04:01:43.557",
      "Version": 5
    }
  ]
},
{
  "title": "Windows Processes Suspicious Parent Directory",
  "id": "96036718-71cc-4027-a538-d1587e0006a7",
  "description": "Detect suspicious parent processes of well-known Windows processes",
  "sigmafile": "",
  "sigma": [
    "SELECT * FROM logs WHERE Channel='Microsoft-Windows-Sysmon/Operational' AND (EventID=1 AND ((Image LIKE '%\\\\svchost.exe' ESCAPE '\\' OR Image LIKE '%\\\\taskhost.exe' ESCAPE '\\' OR Image LIKE '%\\\\lsm.exe' ESCAPE '\\' OR Image LIKE '%\\\\lsass.exe' ESCAPE '\\' OR Image LIKE '%\\\\services.exe' ESCAPE '\\' OR Image LIKE '%\\\\lsaiso.exe' ESCAPE '\\' OR Image LIKE '%\\\\csrss.exe' ESCAPE '\\' OR Image LIKE '%\\\\wininit.exe' ESCAPE '\\' OR Image LIKE '%\\\\winlogon.exe' ESCAPE '\\') AND (NOT (((ParentImage LIKE '%\\\\SavService.exe' ESCAPE '\\' OR ParentImage LIKE '%\\\\ngen.exe' ESCAPE '\\') OR (ParentImage LIKE '%\\\\System32\\\\%' ESCAPE '\\' OR ParentImage LIKE '%\\\\SysWOW64\\\\%' ESCAPE '\\')) OR ((ParentImage LIKE '%\\\\Windows Defender\\\\%' ESCAPE '\\' OR ParentImage LIKE '%\\\\Microsoft Security Client\\\\%' ESCAPE '\\') AND ParentImage LIKE '%\\\\MsMpEng.exe' ESCAPE '\\') OR (ParentImage IS NULL OR (ParentImage='' OR ParentImage='-'))))))"
  ],
  "rule_level": "low",
  "tags": [
    "attack.defense-evasion",
    "attack.t1036.003",
    "attack.t1036.005"
  ],
  "count": 1,
  "matches": [
    {
      "row_id": 7,
      "Channel": "Microsoft-Windows-Sysmon/Operational",
      "CommandLine": "C:\\Windows\\system32\\svchost.exe",
      "Company": "Microsoft Corporation",
      "Computer": "IEWIN7",
      "CurrentDirectory": "C:\\Windows\\system32\\",
      "Description": "Host Process for Windows Services",
      "EventID": 1,
      "EventRecordID": 4863,
      "FileVersion": "6.1.7600.16385 (win7_rtm.090713-1255)",
      "Guid": "5770385F-C22A-43E0-BF4C-06F5698FFBD9",
      "Hashes": "SHA1=4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878,MD5=54A47F6B5E09A77E61649109C6A08866,SHA256=121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2,IMPHASH=58E185299ECCA757FE68BA83A6495FDE",
      "IMPHASH": "58E185299ECCA757FE68BA83A6495FDE",
      "Image": "C:\\Windows\\System32\\svchost.exe",
      "IntegrityLevel": "System",
      "Keywords": "0x8000000000000000",
      "Level": 4,
      "LogonGuid": "365ABB72-8DBD-5CEA-0000-0020E7030000",
      "LogonId": "0x3e7",
      "MD5": "54A47F6B5E09A77E61649109C6A08866",
      "Opcode": 0,
      "OriginalLogfile": "apt10_jjs_sideloading_prochollowing_persist_as_service_sysmon_1_7_8_13.evtx",
      "ParentCommandLine": "\"C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe\"",
      "ParentImage": "C:\\Users\\IEUser\\Desktop\\info.rar\\jjs.exe",
      "ParentProcessGuid": "365ABB72-0FA6-5CEA-0000-0010FEC30A00",
      "ParentProcessId": 3884,
      "ProcessGuid": "365ABB72-0FA7-5CEA-0000-001064C60A00",
      "ProcessID": 984,
      "Product": "Microsoft® Windows® Operating System",
      "Provider_Name": "Microsoft-Windows-Sysmon",
      "SHA1": "4AF001B3C3816B860660CF2DE2C0FD3C1DFB4878",
      "SHA256": "121118A0F5E0E8C933EFD28C9901E54E42792619A8A3A6D11E1F0025A7324BC2",
      "SystemTime": "2019-05-26T04:01:43.567204Z",
      "Task": 1,
      "TerminalSessionId": 0,
      "ThreadID": 2352,
      "User": "NT AUTHORITY\\SYSTEM",
      "UserID": "S-1-5-18",
      "UtcTime": "2019-05-26 04:01:43.557",
      "Version": 5
    }
  ]
}]